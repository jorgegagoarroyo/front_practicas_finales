"use strict";(self["webpackChunkvue_practicas"]=self["webpackChunkvue_practicas"]||[]).push([[599],{599:function(t,e,a){a.r(e),a.d(e,{default:function(){return v}});var s=a(252);const o={class:"col"};function r(t,e,a,r,i,n){const l=(0,s.up)("lista-datos");return(0,s.wg)(),(0,s.iD)("div",{class:"row",key:i.s_tabla},[(0,s._)("div",o,[(0,s.Wm)(l,{tabla:i.s_tabla.nombre,editar:i.s_tabla.editar,borrar:i.s_tabla.borrar},null,8,["tabla","editar","borrar"])])])}var i=a(577),n=a(963);const l={class:"row"},c={class:"col m-2"},d={class:"row"},h={class:"table table-bordered"},u={key:0},b={key:0,class:"col-2"},m=["onClick"],p=["onClick"];function k(t,e,a,o,r,k){return(0,s.wg)(),(0,s.iD)("div",{class:"container",key:r.token},[(0,s._)("div",l,[(0,s._)("div",c,[r.creador?((0,s.wg)(),(0,s.iD)("button",{key:0,class:"btn btn-secondary col-2",onClick:e[0]||(e[0]=e=>k.editar_elemento(t.dato))},"Agregar "+(0,i.zw)(r.elemento_nombre),1)):(0,s.kq)("",!0)])]),(0,s._)("div",d,[(0,s._)("table",h,[(0,s._)("thead",null,[(0,s._)("tr",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.titulos,((t,e)=>((0,s.wg)(),(0,s.iD)(s.HY,null,["id"!==t?((0,s.wg)(),(0,s.iD)("th",{key:e},(0,i.zw)(t),1)):(0,s.kq)("",!0)],64)))),256)),r.edits||r.deletes?((0,s.wg)(),(0,s.iD)("th",u)):(0,s.kq)("",!0)])]),(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.datos,((t,e)=>((0,s.wg)(),(0,s.iD)("tr",{key:e},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.titulos,((e,a)=>((0,s.wg)(),(0,s.iD)(s.HY,null,["id"!==e?((0,s.wg)(),(0,s.iD)("td",{class:"col",key:a},(0,i.zw)(t[e]),1)):(0,s.kq)("",!0)],64)))),256)),r.edits||r.deletes?((0,s.wg)(),(0,s.iD)("td",b,[(0,s.wy)((0,s._)("button",{class:"bg-primary rounded m-2 p-1",onClick:e=>k.editar_elemento(t)},"editar",8,m),[[n.F8,r.edits]]),(0,s.wy)((0,s._)("button",{class:"bg-danger rounded m-2 p-1",onClick:e=>k.eliminar_elemento(t)},"eliminar",8,p),[[n.F8,r.deletes]])])):(0,s.kq)("",!0)])))),128))])])])])}var w={name:"ListaDatos",props:{tabla:{required:!0},editar:{default:!1},borrar:{default:!1}},data(){return{edits:!1,deletes:!1,titulos:[],datos:[],token:"",elemento_nombre:"",creador:!1}},methods:{async leer_elementos(){const t=`https://fp-control.herokuapp.com/api/${this.tabla}/get`;let e=await fetch(t,{method:"POST",headers:{authorization:`bearer ${this.token.token}`,"Content-type":"application/json; charset=UTF-8"}});e=await e.json(),this.datos=e.resul},async leer_campos(){const t=`https://fp-control.herokuapp.com/api/${this.tabla}/campos`;let e=await fetch(t,{method:"GET",headers:{authorization:`bearer ${this.token.token}`,"Content-type":"application/json; charset=UTF-8"}});e=await e.json(),e=e.fields,delete e.pass,this.titulos=Object.keys(e)},async editar_elemento(t){const e=await JSON.stringify(t);this.$router.push({name:"elemento",params:{tabla:this.tabla,existe:e,editar:this.edits,borrar:this.deletes}})},async eliminar_elemento(t){const e=`https://fp-control.herokuapp.com/api/${this.tabla}`;let a={id:t.id};a={campos:a};const s=await fetch(e,{method:"DELETE",headers:{authorization:`bearer ${this.token.token}`,"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify(a)});200===s.status&&this.load()},cambiar_botones(){"true"===this.editar&&(this.edits=!0),"true"===this.borrar&&(this.deletes=!0)},get_token(){let t=localStorage.getItem("control");t=JSON.parse(t),t||this.$router.push("/"),"admin"!==t.rol&&"secretaria"!==t.rol||(this.creador=!0),this.token=t},async load(){try{this.elemento_nombre=this.tabla.slice(0,-1),await this.get_token(),this.cambiar_botones(),await this.leer_campos(),await this.leer_elementos()}catch{console.log("")}}},async mounted(){this.load()}},_=a(744);const y=(0,_.Z)(w,[["render",k]]);var g=y,f={name:"ListaView",data(){return{s_tabla:!1}},props:{tabla:{default:""},editar:{default:!1},borrar:{default:!1}},methods:{load(){const t={nombre:this.tabla,editar:this.editar,borrar:this.borrar};this.s_tabla=t}},async mounted(){this.load()},components:{ListaDatos:g},watch:{tabla:function(){this.load()}}};const D=(0,_.Z)(f,[["render",r]]);var v=D}}]);
//# sourceMappingURL=599.8496e556.js.map